
SYS=$(shell gcc -dumpmachine)

ifneq (,$(findstring,mingw,$(SYS)))
        STATIC=-static
endif



OBJECTS := util.o elapsedtime.o myEXIFDialog.o myPropertyDialog.o myHistogramPane.o myHistogramDialog.o CurvePane.o PicProcessor.o PicProcessorBlackWhitePoint.o PicProcessorHighlight.o PicProcessorShadow.o PicProcessorCurve.o PicProcessorGamma.o PicProcessorBright.o PicProcessorContrast.o PicProcessorSaturation.o PicProcessorSharpen.o PicProcessorResize.o PicProcessorDenoise.o PicProcessorRotate.o PicProcessorGray.o PicProcessorCrop.o rawprocFrm.o rawprocApp.o PicProcPanel.o PicPanel.o

#localmake.txt: += any of these to add, = to replace:

CXX=@CXX@
LD=@CXX@
#WINDRES=windres

#Set to the libraries and flags needed for wxWidgets
WXLIBS=
WXFLAGS=
#if you have wxWidgets installed in a standard place, you can use wx-config as follows:
#WXLIBS=$(shell wx-config --libs std,aui,propgrid)
#WXFLAGS=$(shell wx-config --cxxflags)

#LIBS=-lgimage -lraw -ltiff -ljpeg -llcms2 
LIBS=@LIBS@
CPPFLAGS=@CPPFLAGS@
CXXFLAGS=@CXXFLAGS@
LDFLAGS=@LDFLAGS@
INCLUDEDIRS=@CPPFLAGS@
EXT=@EXEEXT@

srcdir=@srcdir@
VPATH=@srcdir@


#LIBDIRS=	#-L to libraw, libjpeg, libtiff, liblcms2 if any is not installed in a gcc-searched lib path
#INCLUDEDIRS=	#-I to libraw, libjpeg, libtiff, liblcms2 if any is not installed in a gcc-searched include path
#CFLAGS=		#Use += to add any unique compiler flags
#LFLAGS=		#Use += to add any unique linker flags
#EXT=		#If you executable needs a file extension, specify it here (for cross-compiling, because I can't figure out how to make ld do it)

#This includes local unique configuration
#-include $(OBJDIR)/localmake.txt

all: rawproc img

rawproc:  $(OBJECTS)
	mkdir -p bin
	$(CXX) $(LDFLAGS) -o bin/rawproc$(EXT) $(OBJECTS)  $(LIBS) 

img: img.o elapsedtime.o
	mkdir -p bin
	$(CXX) $
	$(CXX) $(LDFLAGS) $(STATIC) -o bin/rawproc$(EXT) img.o elapsedtime.o $(LIBS)

img.o: $(srcdir)/img.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -std=c++11 -c $(srcdir)/img.cpp -o$@

elapsedtime.o: $(srcdir)/elapsedtime.cpp
	$(CXX) -c $(srcdir)/elapsedtime.cpp  -o$@

util.o: $(srcdir)/util.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/util.cpp  -o$@

myPropertyDialog.o: $(srcdir)/myPropertyDialog.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/myPropertyDialog.cpp  -o$@

myEXIFDialog.o: $(srcdir)/myEXIFDialog.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/myEXIFDialog.cpp  -o$@

myHistogramPane.o: $(srcdir)/myHistogramPane.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/myHistogramPane.cpp  -o$@

myHistogramDialog.o: $(srcdir)/myHistogramDialog.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/myHistogramDialog.cpp  -o$@

CurvePane.o: $(srcdir)/CurvePane.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -w -c $(srcdir)/CurvePane.cpp  -o$@

PicProcPanel.o: $(srcdir)/PicProcPanel.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcPanel.cpp  -o$@

PicPanel.o: $(srcdir)/PicPanel.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicPanel.cpp  -o$@

PicProcessorBlackWhitePoint.o: $(srcdir)/PicProcessorBlackWhitePoint.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorBlackWhitePoint.cpp -o$@

PicProcessorHighlight.o: $(srcdir)/PicProcessorHighlight.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorHighlight.cpp -o$@

PicProcessorShadow.o: $(srcdir)/PicProcessorShadow.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorShadow.cpp -o$@

PicProcessorCurve.o: $(srcdir)/PicProcessorCurve.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorCurve.cpp -o$@

PicProcessorGamma.o: $(srcdir)/PicProcessorGamma.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorGamma.cpp -o$@

PicProcessorBright.o: $(srcdir)/PicProcessorBright.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorBright.cpp -o$@

PicProcessorContrast.o: $(srcdir)/PicProcessorContrast.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorContrast.cpp -o$@

PicProcessorSaturation.o: $(srcdir)/PicProcessorSaturation.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorSaturation.cpp -o$@

PicProcessorGray.o: $(srcdir)/PicProcessorGray.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorGray.cpp -o$@

PicProcessorCrop.o: $(srcdir)/PicProcessorCrop.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorCrop.cpp -o$@

PicProcessorResize.o: $(srcdir)/PicProcessorResize.cpp 
	$(CXX) $(CFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorResize.cpp -o$@

PicProcessorSharpen.o: $(srcdir)/PicProcessorSharpen.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorSharpen.cpp -o$@

PicProcessorRotate.o: $(srcdir)/PicProcessorRotate.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorRotate.cpp -o$@

PicProcessorDenoise.o: $(srcdir)/PicProcessorDenoise.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessorDenoise.cpp -o$@

PicProcessor.o: $(srcdir)/PicProcessor.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/PicProcessor.cpp -o$@

rawprocFrm.o: $(srcdir)/rawprocFrm.cpp
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/rawprocFrm.cpp -o$@

rawprocApp.o: $(srcdir)/rawprocApp.cpp 
	$(CXX) $(CXXFLAGS) $(INCLUDEDIRS) -c $(srcdir)/rawprocApp.cpp  -o$@

resource.o: $(srcdir)/resource.rc
ifneq (,$(findstring,mingw,$(SYS)))
        windres -c $(srcdir)/resource.rc -o$@
endif

makedoc:
	zip  -r -j rawprocdoc.zip $(srcdir)/doc/*

clean:
	rm -f *.o rawproc$(EXT) img$(EXT) 

cleandoc:
	rm -f rawprocdoc.zip



